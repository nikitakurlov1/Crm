# Деплой на Render

## Подготовка к деплою

### 1. Убедитесь, что ваш код закоммичен в Git
```bash
git add .
git commit -m "Prepare for Render deployment"
git push origin main
```

### 2. Настройка на Render

1. Перейдите на [render.com](https://render.com)
2. Создайте новый Web Service
3. Подключите ваш GitHub репозиторий
4. Настройте следующие параметры:

#### Основные настройки:
- **Name**: `Crm-1` (или любое другое уникальное имя)
- **Environment**: `Node`
- **Branch**: `main`
- **Root Directory**: оставьте **пустым** (рекомендуется) или укажите `Crm` если папка находится в корне репозитория
- **Build Command**: `npm install`
- **Start Command**: `node server.js`

#### Environment Variables:
Добавьте следующие переменные окружения:

| NAME | VALUE |
|------|-------|
| `NODE_ENV` | `production` |
| `PORT` | `3000` |
| `JWT_SECRET` | `your-super-secure-jwt-secret-key` |
| `DATABASE_URL` | `./crypto_data.db` |

#### Instance Type:
- Для начала выберите **Free** план
- Позже можно будет обновить до платного плана

### 3. Деплой

1. Нажмите "Create Web Service"
2. Render автоматически начнет сборку и деплой
3. Дождитесь завершения процесса (обычно 5-10 минут)

### 4. После деплоя

1. Ваш сайт будет доступен по URL вида: `https://your-service-name.onrender.com`
2. Проверьте работу всех функций
3. Настройте кастомный домен если нужно

## Возможные проблемы и решения

### Проблема: Приложение не запускается
**Решение**: Проверьте логи в Render Dashboard, убедитесь что:
- Все зависимости установлены
- Команда `node server.js` выполняется успешно
- Порт настроен правильно

### Проблема: База данных не инициализируется
**Решение**: Убедитесь что:
- Файл `database.js` корректно настроен
- Права доступа к файлам базы данных настроены правильно

### Проблема: WebSocket соединения не работают
**Решение**: Render поддерживает WebSocket, но убедитесь что:
- Клиент подключается к правильному URL
- Протокол указан как `wss://` для HTTPS

## Мониторинг и логи

- Логи доступны в Render Dashboard
- Можно настроить уведомления об ошибках
- Мониторинг производительности встроен в Render

## Обновления

При каждом push в ветку `main` Render автоматически:
1. Скачает новый код
2. Установит зависимости
3. Перезапустит приложение

## Безопасность

- Никогда не коммитьте `.env` файлы
- Используйте сильные секретные ключи для JWT
- Настройте HTTPS (автоматически в Render)
- Регулярно обновляйте зависимости
